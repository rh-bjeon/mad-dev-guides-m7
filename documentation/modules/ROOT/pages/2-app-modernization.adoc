= 2. 애플리케이션 현대화 - 15분
:imagesdir: ../assets/images

== 이 랩의 목표

이 랩의 목표는 개발자가 Red Hat Developer Hub를 사용하여 OpenShift Application Platform으로 애플리케이션을 신속하게 현대화하는 방법을 배우는 것입니다. *Red Hat Developer Hub* 는 이미 *Red Hat Single Sign-On*, *OpenShift Pipelines*, *OpenShift GitOps*, *GitLab* 으로 구성되어 있습니다. 이 섹션에서는 Red Hat Developer Hub를 사용하여 몇 번의 클릭만으로 *Cool Store Application* 에 속한 모든 백엔드 마이크로서비스를 마이그레이션합니다.

*모듈 목표*:

* 기존 **소프트웨어 템플릿**을 사용하여 **Quarkus Java 애플리케이션**의 컴포넌트를 생성합니다.
* RHDH에서 애플리케이션 세부 정보를 개요로 확인하고, 토폴로지 보기, 파이프라인 정보를 탐색합니다.
* 생성된 소스 코드 저장소의 개요를 확인합니다.
* 기존 **소프트웨어 템플릿**을 사용하여 **Spring Boot Java 애플리케이션**의 컴포넌트를 생성합니다.
* RHDH에서 **OpenShift**로 연결되는 애플리케이션 세부 정보, 토폴로지 보기, 파이프라인 정보를 개요로 확인합니다.

== 2.1 Globex의 디지털 전환 여정
가상의 소매 회사인 Globex는 현대화 여정의 일환으로 기존 소매 전자상거래 웹 애플리케이션을 현대화했습니다.

현대화 과정의 일환으로 Globex는 소프트웨어 개발 수명 주기를 가속화하고, 시장 출시 시간을 단축하는 최선의 방법을 찾고 있습니다.

**참고**: 다음 서비스에는 개발에 적합한 임베디드 데이터베이스가 내장되어 있습니다. 이 실습에서는 데이터베이스를 설정할 필요가 없습니다.

== 2.2 Java Quarkus 애플리케이션 이동: Inventory

=== 2.2.1 소프트웨어 템플릿을 사용하여 첫 번째 Quarkus 애플리케이션 빌드 및 배포

* 왼쪽 메뉴에서 **Create**를 클릭합니다:

* **Quarkus Backend Application** 템플릿을 선택합니다:

image:module2/software_template_quarkus.png[width=50%]  

사전 정의된 소프트웨어 템플릿을 기반으로 컴포넌트를 만드려면 다음 단계를 따르세요.

**Step 1** - GitLab 위치에 대한 정보 제공:

* **Repo Host**: 이미 OpenShift에 설치된 GitLab 도메인입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 소스 저장소와 매니페스트를 업로드합니다.
** **Repo Host**를 OpenShift 도메인으로 교체합니다.

[.console-input]
[source,bash]
----
gitlab-gitlab.%SUBDOMAIN%
----

image:module2/st_gitlab_info.png[width=65%]  

* **Repo Group**: 이미 구성된 GitLab 조직입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 소스 저장소와 매니페스트를 업로드합니다.

* **Next**를 클릭합니다.

**Step 2** - 클러스터 ID에 대한 정보 제공:

* **Cluster Id**: OpenShift 도메인입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 애플리케이션을 빌드하고 배포합니다.
** **Cluster Id**를 OpenShift 도메인으로 교체합니다.

[.console-input]
[source,bash]
----
.%SUBDOMAIN%
----

image:module2/st_component_clusterid.png[width=65%]  

* **Namespace**: OpenShift 네임스페이스입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 해당 네임스페이스에 애플리케이션을 빌드하고 배포합니다.
** **N**을 유저 번호로 교체합니다.

[.console-input]
[source,bash]
----
rhdhub-%USERID%
----

image:module2/st_component_namespace.png[width=40%]  

*Note*: 각 참가자는 모든 애플리케이션에 사용할 고유한 네임스페이스를 할당받았습니다. 각 애플리케이션은 유저 이름을 기반으로 한 공유 식별자를 가집니다.

* **Owner**: Owner는 유저 ID입니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다. 
** 유저 ID를 입력합니다.

[.console-input]
[source,bash]
----
%USERID%
----

image:module2/st_component_owner.png[width=40%]  

* **Next**를 클릭합니다.

**Step 3** - 빌드 정보 제공:

* **Image Host**: 애플리케이션 이미지가 저장될 레지스트리 URL입니다. 이 실습에서는 OpenShift의 내부 레지스트리를 사용합니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다.

* **Image Tag**: 이미지를 식별하는 이미지 태그입니다. 애플리케이션 이름과 태그로 이미지를 구성합니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다.

* **Component ID**: Component ID는 애플리케이션 이름입니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다.

** **Component ID**를 **당신의** 유저 번호로 교체합니다.

[.console-input]
[source,bash]
----
inventory-app-%USERID%
----

image:module2/st_component_componentid_quarkus.png[width=40%]  

* **Review**를 클릭합니다.

* 데이터를 검토합니다.

**샘플 데이터**

image:module2/st_component_review_quarkus.png[width=80%]  

* **Create**를 클릭합니다.

=== 2.2.2 애플리케이션 개요 탐색

축하합니다! 이제 **Red Hat Developer Hub**를 사용하여 첫 번째 애플리케이션을 빌드했습니다. 컴포넌트와 애플리케이션 개요를 탐색할 시간입니다.

* 모든 작업이 녹색으로 표시되면, **Open Component in catalog**를 클릭합니다.

image:module2/task_activity.png[width=100%]  

* RHDH는 컴포넌트 정보가 있는 새 탭을 엽니다.
** 화면에 표시된 정보를 검토합니다.

image:module2/inventory_overview.png[width=100%] 

* 새로 생성된 소스 코드 저장소에 접근하려면 **VIEW SOURCE**를 클릭합니다.

image:module2/inventory_source.png[width=50%] 

* Red Hat Developer Hub에서 inventory 컴포넌트로 돌아갑니다: https://developer-hub-backstage-rhdhub.%SUBDOMAIN%/catalog/default/component/inventory-app-%USERID%[Red Hat Developer Hub UI^].

* 파이프라인 정보를 검토하려면 **CI** 탭을 클릭합니다. 몇 초 후 파이프라인이 시작됩니다. 몇 분 후 파이프라인이 **Succeeded** 상태로 완료된 것을 볼 수 있습니다.

image:module2/inventory_pipeline.png[width=100%] 

* 배포 상태를 검토하려면 **TOPOLOGY**를 클릭합니다. 파이프라인이 성공하면 deployment가 **파란색**으로 표시됩니다.
** Deployment **inventory-app-%USERID%**를 클릭합니다.

오른쪽에 애플리케이션 세부 정보가 표시됩니다.

image:module2/inventory_deployment.png[width=100%] 

*Note*: 다음 섹션에서 이 보기(view)를 계속 탐색할 것입니다.


== 2.3 Spring Boot 애플리케이션 이동: Catalog 애플리케이션

=== 2.3.1 소프트웨어 템플릿을 사용하여 첫 번째 Spring Boot 애플리케이션 빌드 및 배포

* 왼쪽 메뉴에서 **Create**를 클릭합니다.

* **Spring Boot 백엔드 애플리케이션** 템플릿을 선택합니다.

image:module2/software_templates_spring.png[width=50%]   

사전 정의된 소프트웨어 템플릿을 기반으로 구성 요소를 만들려면 다음 단계를 따르세요.

**Step 1** - GitLab 위치에 대한 정보 제공:

* **Repo Host**: 이미 OpenShift에 설치된 GitLab 도메인입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 소스 저장소와 매니페스트를 업로드합니다.
** **Repo Host**를 OpenShift 도메인으로 교체합니다.

[.console-input]
[source,bash]
----
gitlab-gitlab.%SUBDOMAIN%
----

image:module2/st_gitlab_info.png[width=65%]  

* **Repo Group**: 이미 구성된 GitLab 조직입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 소스 저장소와 매니페스트를 업로드합니다.

* **Next**를 클릭합니다.

**Step 2** - 클러스터 ID에 대한 정보 제공:

* **Cluster Id**: OpenShift 도메인입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 애플리케이션을 빌드하고 배포합니다.
** **Cluster Id**를 OpenShift 도메인으로 교체합니다.

[.console-input]
[source,bash]
----
.%SUBDOMAIN%
----

image:module2/st_component_clusterid.png[width=40%] 


* **Namespace**: OpenShift 네임스페이스입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 해당 네임스페이스에 애플리케이션을 빌드하고 배포합니다.
** **Namespace**를 다음으로 교체합니다.

[.console-input]
[source,bash]
----
rhdhub-%USERID%
----

image:module2/st_component_namespace.png[width=40%] 

*Note*: 각 참가자는 모든 애플리케이션에 사용할 고유한 네임스페이스를 할당받았습니다. 각 애플리케이션은 유저 이름을 기반으로 한 공유 식별자를 가집니다.

* **Owner**: Owner는 유저 ID입니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다. 
** 유저 ID를 입력합니다.

[.console-input]
[source,bash]
----
%USERID%
----

image:module2/st_component_owner.png[width=40%]  

* **Next**를 클릭합니다.

**Step 3** - 빌드 정보 제공:

* **Image Host**: 애플리케이션 이미지가 저장될 레지스트리 URL입니다. 이 실습에서는 OpenShift의 내부 레지스트리를 사용합니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다.

* **Image Tag**: 이미지를 식별하는 이미지 태그입니다. 애플리케이션 이름과 태그로 이미지를 구성합니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다.

* **Component ID**: Component ID는 애플리케이션 이름입니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다.

** **Component ID**를 **당신의** 유저 번호로 교체합니다.

[.console-input]
[source,bash]
----
catalog-app-%USERID%
----

image:module2/st_component_componentid_spring.png[width=50%]  

* **Review**를 클릭합니다.

* 데이터를 검토합니다.

**샘플 데이터**

image:module2/st_component_review_spring.png[width=80%]  

* **Create**를 클릭합니다.

=== 2.3.2 애플리케이션 개요 탐색

축하합니다! 이제 **Red Hat Developer Hub**를 사용하여 첫 번째 Spring Boot 애플리케이션을 빌드했습니다. 컴포넌트와 애플리케이션 개요를 탐색할 시간입니다.

* 모든 작업이 녹색으로 표시되면, **Open Component in catalog**를 클릭합니다.

image:module2/task_activity.png[width=100%]   

* RHDH는 컴포넌트 정보가 있는 새 탭을 엽니다.
** 화면에 표시된 정보를 검토합니다.

image:module2/catalog_overview.png[width=100%] 

* **Overview** 탭에서 **Pipelines**를 클릭하여 OpenShift의 파이프라인 세부 정보를 검토합니다.

**Note**: 파이프라인이 보이지 않으면 링크를 다시 클릭하여 OpenShift 파이프라인 세부 정보로 리디렉션되는지 확인하세요.

image:module2/overview_pipelines_click.png[width=65%] 

파이프라인이 녹색이 ​​될 때까지 기다리세요. 파이프라인이 완료되는 데 몇 분이 걸립니다.

image:module2/pipelines_openshift.png[width=65%] 

* Red Hat Developer Hub의 catalog component로 돌아갑니다: https://developer-hub-backstage-rhdhub.%SUBDOMAIN%/catalog/default/component/catalog-app-%USERID%[Red Hat Developer Hub UI^].

**Overview** 탭에서 **Deployment**를 클릭하여 OpenShift에서 배포 상태를 검토합니다.

image:module2/overview_deployment_click.png[width=65%] 

파이프라인이 성공하면 Deployment가 즉시 **파란색**으로 표시됩니다.

**Note**: 개발자가 접근 권한을 갖고 있는 경우, RHDH를 사용하면 OpenShift에서 동일한 정보를 검토할 수 있는 유연성이 제공됩니다.

image:module2/catalog_deployment.png[width=65%]

**Note**: 다음 모듈에서 이 관점에 대해 계속해서 살펴보겠습니다.

## 축하합니다!
CI/CD를 사용하여 Cool Store 애플리케이션에 필요한 백엔드 서비스를 성공적으로 빌드하고 배포했습니다. 두 개의 소프트웨어 템플릿을 사용하여 Spring Boot 및 Quarkus 애플리케이션을 빌드했습니다. 회사 지침 및 아키텍처에 따라 애플리케이션의 요구 사항을 충족하기 위해 더 많은 템플릿을 사용할 수 있습니다.