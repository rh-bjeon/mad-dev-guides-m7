= 3. 애플리케이션 개발 - 25분
:imagesdir: ../assets/images

== 이 랩의 목표

이 랩의 목표는 새로운 소프트웨어 템플릿을 사용하여더 많은 현대화를 모색하는 것입니다. 

또한 개발자가 **Red Hat OpenShift Dev Spaces**를 사용하여 자유롭게 코딩하는 방법을 보여줍니다. 이 섹션에서는 **gateway** 및 **frontend** 마이크로서비스를 마이그레이션하여 Cool Store 애플리케이션의 배포를 완료합니다.


**모듈 목표**:

* 기존 **소프트웨어 템플릿**을 사용하여 **Frontend NodeJS(Angular) 애플리케이션**의 컴포넌트를 생성합니다.
* 기존 **소프트웨어 템플릿**을 사용하여 **Gateway Java 애플리케이션**의 컴포넌트를 생성합니다.
* 애플리케이션 세부정보, ArgoCD 및 클러스터 정보의 개요를 확인합니다.
* Red Hat Developer Hub에서 GitLab 이슈를 확인합니다.
* Red Hat OpenShift Dev Spaces를 사용하여 GitLab 이슈를 해결합니다.
* API와 애플리케이션 종속성을 살펴봅니다.

== 3.1 Gateway Java 애플리케이션 이동

=== 3.1.1 소프트웨어 템플릿을 사용하여 첫 번째 Gateway 애플리케이션 빌드 및 배포

* 왼쪽 메뉴에서 **Create**를 클릭합니다:

* **Java Gateway Application** 템플릿을 선택합니다:

image:module3/software_templates_gateway.png[width=50%]  

사전 정의된 소프트웨어 템플릿을 기반으로 컴포넌트를 만드려면 다음 단계를 따르세요.

**Step 1** - GitLab 위치에 대한 정보 제공:

* **Repo Host**: 이미 OpenShift에 설치된 GitLab 도메인입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 소스 저장소와 매니페스트를 업로드합니다.
** **Repo Host**를 OpenShift 도메인으로 교체합니다.

[.console-input]
[source,bash]
----
gitlab-gitlab.%SUBDOMAIN%
----

image:module3/st_gitlab_info.png[width=65%]  

* **Repo Group**: 이미 구성된 GitLab 조직입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 소스 저장소와 매니페스트를 업로드합니다.

* **Next**를 클릭합니다.

**Step 2** - 클러스터 ID에 대한 정보 제공:

* **Cluster Id**: OpenShift 도메인입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 애플리케이션을 빌드하고 배포합니다.
** **Cluster Id**를 OpenShift 도메인으로 교체합니다.

[.console-input]
[source,bash]
----
.%SUBDOMAIN%
----

image:module3/st_component_clusterid.png[width=65%]  

* **Namespace**: OpenShift 네임스페이스입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 해당 네임스페이스에 애플리케이션을 빌드하고 배포합니다.
** **Namespace**를 교체합니다.

[.console-input]
[source,bash]
----
rhdhub-%USERID%
----

image:module3/st_component_namespace.png[width=40%]  

*Note*: 각 참가자는 모든 애플리케이션에 사용할 고유한 네임스페이스를 할당받았습니다. 각 애플리케이션은 유저 이름을 기반으로 한 공유 식별자를 가집니다.

* **Owner**: Owner는 유저 ID입니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다. 
** 유저 ID를 입력합니다.

[.console-input]
[source,bash]
----
%USERID%
----

image:module3/st_component_owner.png[width=40%]  

* **Next**를 클릭합니다.

**Step 3** - 빌드 정보 제공:

* **Image Host**: 애플리케이션 이미지가 저장될 레지스트리 URL입니다. 이 실습에서는 OpenShift의 내부 레지스트리를 사용합니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다.

* **Image Tag**: 이미지를 식별하는 이미지 태그입니다. 애플리케이션 이름과 태그로 이미지를 구성합니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다.

* **Component ID**: Component ID는 애플리케이션 이름입니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다.

** **Component ID**를 **당신의** 유저 번호로 교체합니다.

[.console-input]
[source,bash]
----
gateway-app-%USERID%
----

image:module3/st_component_componentid_gateway.png[width=65%]  

* **Review**를 클릭합니다.

* 데이터를 검토합니다.

**샘플 데이터**

image:module3/st_component_review_gateway.png[width=80%]  

* **Create**를 클릭합니다.

=== 3.1.2 애플리케이션 개요 탐색

축하합니다! 이제 **Red Hat Developer Hub**를 사용하여 Java Gateway 애플리케이션을 빌드했습니다. 컴포넌트와 애플리케이션 개요를 탐색할 시간입니다.

* 모든 작업이 녹색으로 표시되면, **Open Component in catalog**를 클릭합니다.

image:module3/task_activity.png[width=100%]  

* RHDH는 컴포넌트 정보가 있는 새 탭을 엽니다.
** 화면에 표시된 정보를 검토합니다.

image:module3/gateway_overview.png[width=100%]  

* 파이프라인 정보를 검토하려면 **CI** 탭을 클릭합니다. 몇 초 후 파이프라인이 시작됩니다. 몇 분 후 파이프라인이 **Succeeded** 상태로 완료된 것을 볼 수 있습니다.

image:module3/gateway_pipelines.png[width=100%] 

* 배포 상태를 검토하려면 **TOPOLOGY**를 클릭합니다. 파이프라인이 성공하면 deployment가 **파란색**으로 표시됩니다.
** Deployment **gateway-app-%USERID%**를 클릭합니다.

오른쪽에 애플리케이션 세부 정보가 표시됩니다.

image:module3/gateway_deployment.png[width=80%] 

* **KUBERNETES**를 클릭하여 애플리케이션의 상태를 확인합니다.
파드가 아직 준비되지 않았다면 모든 것이 녹색으로 표시될 때까지 몇 초 동안 기다리세요.

**Note**: **1 pod with errors**는 **Error Reporting** 섹션에 표시된 대로 pod가 실패했음을 나타냅니다. 문제가 해결되면 이제 모든 pod가 녹색입니다.

image:module3/gateway_yourclusters.png[width=100%] 

** 파드 정보 확장:

image:module3/gateway_kubernetes_clusters_ok.png[width=100%] 

모든 내용이 녹색이면 다음 섹션으로 넘어갈 준비가 된 것입니다.

**Note**: 다음 섹션에서 이 관점을 계속해서 살펴보겠습니다.


== 3.2 frontend NodeJS 애플리케이션 이동

=== 3.2.1 소프트웨어 템플릿을 사용하여 첫 번째 Frontend 애플리케이션을 빌드 및 배

* 왼쪽 메뉴에서 **Create**를 클릭합니다.

* **Frontend Application** 템플릿을 선택합니다.

image:module3/software_templates_frontend.png[width=50%]  

사전 정의된 소프트웨어 템플릿을 기반으로 구성 요소를 만들려면 다음 단계를 따르세요.

**Step 1** - GitLab 위치에 대한 정보 제공:

* **Repo Host**: 이미 OpenShift에 설치된 GitLab 도메인입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 소스 저장소와 매니페스트를 업로드합니다.
** **Repo Host**를 OpenShift 도메인으로 교체합니다.

[.console-input]
[source,bash]
----
gitlab-gitlab.%SUBDOMAIN%
----

image:module3/st_gitlab_info.png[width=65%]  

* **Repo Group**: 이미 구성된 GitLab 조직입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 소스 저장소와 매니페스트를 업로드합니다.

* **Next**를 클릭합니다.

**Step 2** - 클러스터 ID에 대한 정보 제공:

* **Cluster Id**: OpenShift 도메인입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 애플리케이션을 빌드하고 배포합니다.
** **Cluster Id**를 OpenShift 도메인으로 교체합니다.

[.console-input]
[source,bash]
----
.%SUBDOMAIN%
----

image:module3/st_component_clusterid.png[width=65%]  

* **Namespace**: OpenShift 네임스페이스입니다. Red Hat Developer Hub는 이 입력 데이터를 사용하여 해당 네임스페이스에 애플리케이션을 빌드하고 배포합니다.
** **Namespace**를 다음으로 교체합니다.

[.console-input]
[source,bash]
----
rhdhub-%USERID%
----

image:module3/st_component_namespace.png[width=40%]  

*Note*: 각 참가자는 모든 애플리케이션에 사용할 고유한 네임스페이스를 할당받았습니다. 각 애플리케이션은 유저 이름을 기반으로 한 공유 식별자를 가집니다.

* **Owner**: Owner는 유저 ID입니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다. 
** 유저 ID를 입력합니다.

[.console-input]
[source,bash]
----
%USERID%
----

image:module3/st_component_owner.png[width=40%]  

* **Next**를 클릭합니다.

**Step 3** - 빌드 정보 제공:

* **Image Host**: 애플리케이션 이미지가 저장될 레지스트리 URL입니다. 이 실습에서는 OpenShift의 내부 레지스트리를 사용합니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다.

* **Image Tag**: 이미지를 식별하는 이미지 태그입니다. 애플리케이션 이름과 태그로 이미지를 구성합니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다.

* **Component ID**: Component ID는 애플리케이션 이름입니다. Red Hat Developer Hub는 빌드 및 배포 과정에서 이 입력 데이터를 사용합니다.

** **Component ID**를 **당신의** 유저 번호로 교체합니다.

[.console-input]
[source,bash]
----
frontend-app-%USERID%
----

image:module3/st_component_componentid_frontend.png[width=65%]  

* **Review**를 클릭합니다.

* 데이터를 검토합니다.

**샘플 데이터**

image:module3/st_component_review_frontend.png[width=100%]  

* **Create**를 클릭합니다.

=== 3.2.2 애플리케이션 개요 탐색

축하합니다! 이제 **Red Hat Developer Hub**를 사용하여 첫 번째 프런트엔드 애플리케이션을 빌드했습니다. 컴포넌트와 애플리케이션 개요를 탐색할 시간입니다.

* 모든 작업이 녹색으로 표시되면, **Open Component in catalog**를 클릭합니다.

image:module3/task_activity.png[width=100%]

* RHDH는 컴포넌트 정보가 있는 새 탭을 엽니다.
** 화면에 표시된 정보를 검토합니다.

image:module3/frontend_overview.png[width=100%] 

* 파이프라인 정보를 검토하려면 **CI** 탭을 클릭합니다. 몇 초 후 파이프라인이 시작됩니다. 몇 분 후 파이프라인이 **Succeeded** 상태로 완료된 것을 볼 수 있습니다.

image:module3/frontend_pipeline.png[width=100%]

* 배포 상태를 검토하려면 **TOPOLOGY**를 클릭합니다. 파이프라인이 성공하면 deployment가 **파란색**으로 표시됩니다.
** Deployment **frontend-app-%USERID%**를 클릭합니다.

오른쪽에 애플리케이션 세부 정보가 표시됩니다.

image:module3/frontend_topology.png[width=100%] 

* ARGOCD 기록을 확인하려면 **CD**를 클릭합니다.

image:module3/frontend_argohistory.png[width=100%] 

* 프런트엔드 애플리케이션에 대해 사용/제공된 API를 검토하려면 **API**를 클릭합니다.

image:module3/frontend_apiconsume.png[width=100%] 

* Cool Store UI에 액세스하여 모든 것이 예상대로 작동하는지 확인합니다.

** https://frontend-app-%USERID%-rhdhub-%USERID%.%SUBDOMAIN%/[Cool Store 웹페이지^]를 클릭합니다.

image::module3/ui_web.png[width=100%]

=== 3.5 애플리케이션에 대해 보고된 이슈 수정

개발자로서 여러분은 많은 기능 요청이나 이슈를 처리해야 합니다. 이 사용 사례에서는 프런트엔드 애플리케이션의 title 문제를 해결합니다. Red Hat Developer Hub는 여러분이 한 곳에서 앱의 모든 도구와 정보에 액세스할 수 있게 해주는 단일 창구입니다.

1. Red Hat Developer Hub의 프런트엔드 컴포넌트로 돌아갑니다: https://developer-hub-backstage-rhdhub.%SUBDOMAIN%/catalog/default/component/frontend-app-%USERID%[Red Hat Developer Hub UI^].
2. **ISSUES**를 클릭하여 GitLab 이슈를 확인합니다.
3. 해당 애플리케이션과 관련된 모든 GitLab 이슈를 볼 수 있습니다.

해결해야 할 이가 있습니다.

image:module3/frontend_issues.png[width=100%]

* **issue link**를 클릭하여 정보를 읽어봅니다.

image::module3/frontend_issue_desc.png[width=100%]

* Red Hat Developer Hub의 프런트엔드 컴포넌트로 돌아갑니다: https://developer-hub-backstage-rhdhub.%SUBDOMAIN%/catalog/default/component/frontend-app-%USERID%[Red Hat Developer Hub UI^].

3. **OVERVIEW** 탭에서 **OpenShift Dev Spaces (VS Code)**를 클릭하여 필요한 소스 코드 변경을 수행합니다.

image::module3/frontend_devspaces.png[width=80%]

4. Red Hat OpenShift Dev Spaces에 로그인합니다.

4.1 **Log in with OpenShift** 버튼을 클릭합니다.

image::module3/devspaces_login.png[width=80%]

* Red Hat Single Sign-On(RH-SSO) 화면에서 OpenShift 자격 증명으로 로그인합니다.

 ** *사용자 이름*: `%USERID%`
 ** *비밀번호*: `{openshift-password}`

4.3 **"Allow selected permissions"**을 클릭하여 액세스를 승인합니다.

image::module3/devspaces_authorize.png[width=80%]

4.4 자격 증명을 사용하여 GitLab에 로그인합니다.

 ** *사용자 이름*: `%USERID%`
 ** *비밀번호*: `{openshift-password}`

image::module3/gitlab_authentication.png[width=80%]

4.4 **Authorize** 버튼을 클릭하여 **devspaces**가 여러분의 계정을 사용할 수 있도록 인증합니다.

image::module3/devspaces_authorize_user.png[width=80%]

4.5 Red Hat OpenShift Dev Spaces 작업 공간이 준비될 때까지 기다리세요. 몇 분 정도 걸릴 수 있습니다. workspace가 프로비저닝되는 동안 로딩 화면이 표시되고, Red Hat OpenShift Dev Spaces가 소스 코드 리포지토리에 저장된 devfile을 기반으로 작업 공간을 생성하는데, 이 작업 공간은 도구와 구성을 포함하도록 사용자 정의할 수 있습니다.

image::module3/devspaces_loading.png[width=60%]

4.6 **"Yes, I trust the authors"**를 클릭하여 액세스를 확인합니다.

image::module3/devspaces_trustauthors.png[width=80%]

** **Mark Done**를 클릭합니다.

image::module3/devspaces_view.png[width=80%]

4.7 아래 그림과 같이 `frontend-app-%USERID%`를 확장하여 `header.html` 파일을 찾습니다.

image::module3/file_change.png[width=100%]

4.8 **line 12**의 **Title**을 업데이트하고 선호하는 도시를 추가합니다. Red Hat OpenShift Dev Spaces가 코드를 업데이트하는 동안 자동으로 변경 사항을 저장하므로 파일을 저장할 필요가 없습니다.

*t예시:*

image::module3/dev_file_changed.png[width=80%]

4.9 소스 코드 변경 사항을 커밋합니다.

image::module3/icon_source_control.png[width=60%, float=left]

* **Source Control** 아이콘을 클릭합니다.


    * 커밋에 대한 **Message**를 추가합니다.
    * Commit 옆의 **화살표**를 클립합니다.
    * **Commit & Push** 옵션을 선택합니다.

image::module3/dev_commit.png[width=60%]

* 변경 사항을 확인합니다.

image::module3/dev_confirmed.png[width=100%]

* Red Hat Developer Hub에서 파이프라인을 확인합니다.

소스 코드 변경으로 인해 프런트엔드 애플리케이션 버전을 업데이트하는 새로운 파이프라인이 트리거되었습니다.

* Red Hat Developer Hub의 프런트엔드 컴포넌트로 돌아갑니다: https://developer-hub-backstage-rhdhub.%SUBDOMAIN%/catalog/default/component/frontend-app-%USERID%[Red Hat Developer Hub UI^].

* **CI**를 클릭하여 파이프라인을 확인합니다.

image::module3/frontend_newpipeline.png[width=100%]

* Cool Store 웹페이지를 새로 고칩니다.

쿨스토어 웹페이지에서 **새로운 타이틀**을 보실 수 있습니다.

image::module3/final_web.png[width=100%]

*축하합니다!* git request가 완료되었습니다.

## 보너스 포인트: 애플리케이션 종속성 및 API 탐색

* Red Hat Developer Hub의 프런트엔드 컴포넌트 돌아갑니다: https://developer-hub-backstage-rhdhub.%SUBDOMAIN%/catalog/default/component/frontend-app-%USERID%[Red Hat Developer Hub UI^].

* **Overview** 탭을 클릭합니다. 다음으로, **workshop-system-rhdhub-%USERID%** 섹션을 클릭합니다.

image::module3/overview_workshop.png[width=80%]

* 애플리케이션 컴포넌트와 API를 살펴보세요.
** 이 기능은 시스템이 서로 상호작용하는 방식을 이해하는 데 이상적입니다.

image::module3/workshop_detail.png[width=100%]

* **Relations** 섹션에는 네임스페이스에 설치한 모든 서비스가 표시됩니다.
* **APIs** 섹션에서는 프런트엔드 애플리케이션이 product catalog에서 inventory에 이르기까지 백엔드 서비스 정보에 액세스하는 데 사용하는 게이트웨이 API를 보여줍니다.

## 축하합니다!

Cool Store 애플리케이션을 성공적으로 구축했고, 소프트웨어 템플릿을 갖춘 Red Hat Developer Hub의 이점을 알아보았습니다. 소프트웨어 템플릿은 서비스나 소프트웨어 구성 요소를 구축하고 배포하는 데 사용된 기술의 모든 세부 정보를 배우지 않고도 사전 설계된 지원되는 방식을 제공함으로써 개발자의 인지 부하를 줄여줍니다.